---
title: "Exploratory analysis"
author: "Zhiwen (Owen) Jiang"
date: '2023-10-24'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r library}
library(ggplot2)
```

### Introduction to the data
An observational study was conducted to analyze the effect of smoking cessation on weight gain. The raw data contains $1629$ subjects and $63$ variables. The outcome is weight gain, which is the difference from baseline in weight (in kilograms), and the main factor is smoking cessation. Other variables include age, alcohol consumption, cholesterol level, diabetes, income, marital status, race, sex, etc.


```{r data}
smk_raw <- read.csv('smoking_cessation.csv')
```

At the very beginning, we may want to know the weight distribution of smokers and non-smokers at baseline and at the end of study, respectively. 

```{r plot1}
plot1_data <- smk_raw[, c('seqn', 'wt_bl', 'wt_end', 'qsmk')]
plot1_data$qsmk <- factor(plot1_data$qsmk, levels = c(0, 1), labels = c('No', 'Yes'))
plot1_data <- reshape(plot1_data, direction = 'long', idvar = 'seqn', 
                      varying = c(2, 3), sep='_')
plot1_data$time <- factor(plot1_data$time, levels = c('bl', 'end'), 
                          labels = c('Baseline', 'End'))

ggplot(plot1_data, aes(y = wt, x = qsmk)) + geom_boxplot(fill = 'orange') + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black")) + xlab('Smoking cessation') + ylab('Weight at baseline (kg)') + facet_grid(. ~ time)

```


Since sex is an important confounding for weight change, we also compare the difference.
```{r plot2}
plot2_data <- smk_raw[, c('seqn', 'wt_bl', 'wt_end', 'sex')]
plot2_data$sex <- factor(plot2_data$sex, levels = c(0, 1), labels = c('Male', 'Female'))
plot2_data <- reshape(plot2_data, direction = 'long', idvar = 'seqn', 
                      varying = c(2, 3), sep='_')
plot2_data$time <- factor(plot2_data$time, levels = c('bl', 'end'), 
                          labels = c('Baseline', 'End'))
ggplot(plot2_data, aes(y = wt, x = sex)) + geom_boxplot(fill = 'skyblue') + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(), axis.line = element_line(colour = "black")) + xlab('Sex') + ylab('Weight at baseline (kg)') + facet_grid(. ~ time)
```